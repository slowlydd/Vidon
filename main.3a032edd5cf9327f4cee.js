!function(e){var t={};function i(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(s,o,function(t){return e[t]}.bind(null,o));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){},function(e,t,i){"use strict";i.r(t);let s=0;let o=null;class r{constructor(){this.id=s++,this.observers=[]}addObserver(e){this.observers.push(e)}removeObserver(e){var t=this.observers.indexOf(e);t>-1&&this.observers.splice(t,1)}notify(){this.observers.forEach(e=>{e.update()})}}class n{constructor(e,t,i){this.subjects={},this.vm=e,this.key=t,this.cb=i,this.value=this.getValue()}update(){let e=this.value,t=this.getValue();t!==e&&(this.value=t,this.cb.bind(this.vm)(t,e))}subscribeTo(e){this.subjects[e.id]||(e.addObserver(this),this.subjects[e.id]=e)}getValue(){o=this;let e=this.vm.$data[this.key];return o=null,e}}class a{compile(){this.traverse(this.node)}traverse(e){1===e.nodeType?(this.compileNode(e),e.childNodes.forEach(e=>{this.traverse(e)})):3===e.nodeType&&this.compileText(e)}compileNode(e){let t=[...e.attributes];console.log("TCL: Compile -> compileNode -> attrs",t),t.forEach(t=>{if(this.isModelDirective(t.name)){let i=t.value;e.value=this.vm.$data[i],new n(this.vm,i,(function(t){e.value=t})),e.oninput=e=>{this.vm.$data[i]=e.target.value}}else if(this.isEventDirective(t.name)){let i=t.name.substr(1),s=t.value;e.addEventListener(i,this.vm.$methods[s])}})}isEventDirective(e){return 0===e.indexOf("@")}isModelDirective(e){return"v-model"===e}compileText(e){console.log("TCL: Compile -> compileText -> node",e);let t,i=/{{(.+?)}}/g;for(;t=i.exec(e.nodeValue);){let i=t[0],s=t[1].trim();e.nodeValue=e.nodeValue.replace(i,this.vm.$data[s]),new n(this.vm,s,(function(t,i){e.nodeValue=e.nodeValue.replace(i,t)}))}}constructor(e){this.vm=e,this.node=e.$el,this.compile()}}i(0);let l=new class{constructor(e){this.init(e),function e(t){if(t&&"object"==typeof t)for(var i in t){let s=t[i],n=new r;Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:function(){return o&&o.subscribeTo(n),s},set:function(e){s=e,n.notify()}}),"object"==typeof s&&e(s)}}(this.$data),new a(this)}init(e){this.$el=document.querySelector(e.el),this.$data=e.data,this.$methods=e.methods;for(const e in this.$data)this.$data.hasOwnProperty(e)&&Object.defineProperty(this,e,{enumerable:!0,configurable:!0,get:()=>this.$data[e],set:t=>{this.$data[e]=t}});for(const e in this.$methods)this.$methods.hasOwnProperty(e)&&(Object.defineProperty(this,e,{enumerable:!0,configurable:!0,get:()=>this.$methods[e],set:t=>{this.$methods[e]=t}}),this.$methods[e]=this.$methods[e].bind(this))}}({el:"#app",data:{name:"Â∞èÈ©¨üê¥",age:12,gender:"Áî∑"},methods:{sayHi(){alert(`‰Ω†Â•Ω, ${this.name}`)},auto(){alert("ÊàëËá™Â∑±ÊâßË°åÁöÑ")}}});setTimeout(()=>{l.age=20,l.auto(),setTimeout(()=>{l.auto=()=>{alert("2ÁßíÂêéÊàëÂèàÂºπÂá∫Êù•‰∫Ü")},l.auto()},2e3)},3e3)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvSURHZW5lcmF0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvVmlkb24uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiaWQiLCJjdXJyZW50T2JzZXJ2ZXIiLCJ0aGlzIiwib2JzZXJ2ZXJzIiwib2JzZXJ2ZXIiLCJwdXNoIiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiZm9yRWFjaCIsInVwZGF0ZSIsIk9ic2VydmVyIiwidm0iLCJjYiIsInN1YmplY3RzIiwiZ2V0VmFsdWUiLCJvbGRWYWwiLCJzdWJqZWN0IiwiYWRkT2JzZXJ2ZXIiLCIkZGF0YSIsIkNvbXBpbGUiLCJ0cmF2ZXJzZSIsIm5vZGUiLCJub2RlVHlwZSIsImNvbXBpbGVOb2RlIiwiY2hpbGROb2RlcyIsImNoaWxkTm9kZSIsImNvbXBpbGVUZXh0IiwiYXR0cnMiLCJhdHRyaWJ1dGVzIiwiY29uc29sZSIsImxvZyIsImF0dHIiLCJpc01vZGVsRGlyZWN0aXZlIiwibmV3VmFsIiwib25pbnB1dCIsImUiLCJ0YXJnZXQiLCJpc0V2ZW50RGlyZWN0aXZlIiwiZXZlbnRUeXBlIiwic3Vic3RyIiwibWV0aG9kTmFtZSIsImFkZEV2ZW50TGlzdGVuZXIiLCIkbWV0aG9kcyIsIm1hdGNoIiwicmVnIiwiZXhlYyIsIm5vZGVWYWx1ZSIsInJhdyIsInRyaW0iLCJyZXBsYWNlIiwidmFsIiwiJGVsIiwiY29tcGlsZSIsIm9wdHMiLCJpbml0IiwiUmVhY3RpdmUiLCJkYXRhIiwiY29uZmlndXJhYmxlIiwic3Vic2NyaWJlVG8iLCJzZXQiLCJub3RpZnkiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJlbCIsIm1ldGhvZHMiLCJmbiIsImFnZSIsImdlbmRlciIsImFsZXJ0Iiwic2V0VGltZW91dCIsImF1dG8iXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVBQWViLEVBQVMsYUFBYyxDQUFFbUIsT0FBTyxLQVF2RHJCLEVBQW9Cc0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFyQixFQUFv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M2EwMzJlZGQ1Y2Y5MzI3ZjRjZWUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJsZXQgaWQgPSAwXHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKCkgeyBcclxuICByZXR1cm4gaWQrK1xyXG59IiwiaW1wb3J0IElER2VuZXJhdG9yIGZyb20gXCIuL0lER2VuZXJhdG9yXCI7XHJcbmZ1bmN0aW9uIFJlYWN0aXZlKGRhdGEpIHtcclxuICBpZiAoIWRhdGEgfHwgdHlwZW9mIGRhdGEgIT09IFwib2JqZWN0XCIpIHJldHVybjtcclxuICBmb3IgKHZhciBrZXkgaW4gZGF0YSkge1xyXG4gICAgbGV0IHZhbCA9IGRhdGFba2V5XTtcclxuICAgIGxldCBzdWJqZWN0ID0gbmV3IFN1YmplY3QoKTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShkYXRhLCBrZXksIHtcclxuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGBnZXQgJHtrZXl9OiAke3ZhbH1gKTtcclxuICAgICAgICBpZiAoY3VycmVudE9ic2VydmVyKSB7XHJcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImhhcyBjdXJyZW50T2JzZXJ2ZXJcIik7XHJcbiAgICAgICAgICBjdXJyZW50T2JzZXJ2ZXIuc3Vic2NyaWJlVG8oc3ViamVjdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB2YWw7XHJcbiAgICAgIH0sXHJcbiAgICAgIHNldDogZnVuY3Rpb24obmV3VmFsKSB7XHJcbiAgICAgICAgdmFsID0gbmV3VmFsO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwic3RhcnQgbm90aWZ5Li4uXCIpXHJcbiAgICAgICAgc3ViamVjdC5ub3RpZnkoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBpZiAodHlwZW9mIHZhbCA9PT0gXCJvYmplY3RcIikge1xyXG4gICAgICBSZWFjdGl2ZSh2YWwpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxubGV0IGN1cnJlbnRPYnNlcnZlciA9IG51bGw7XHJcblxyXG5jbGFzcyBTdWJqZWN0IHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuaWQgPSBJREdlbmVyYXRvcigpO1xyXG4gICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcclxuICB9XHJcbiAgYWRkT2JzZXJ2ZXIob2JzZXJ2ZXIpIHtcclxuICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gob2JzZXJ2ZXIpO1xyXG4gIH1cclxuICByZW1vdmVPYnNlcnZlcihvYnNlcnZlcikge1xyXG4gICAgdmFyIGluZGV4ID0gdGhpcy5vYnNlcnZlcnMuaW5kZXhPZihvYnNlcnZlcik7XHJcbiAgICBpZiAoaW5kZXggPiAtMSkge1xyXG4gICAgICB0aGlzLm9ic2VydmVycy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgfVxyXG4gIH1cclxuICBub3RpZnkoKSB7XHJcbiAgICB0aGlzLm9ic2VydmVycy5mb3JFYWNoKG9ic2VydmVyID0+IHtcclxuICAgICAgb2JzZXJ2ZXIudXBkYXRlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmNsYXNzIE9ic2VydmVyIHtcclxuICBjb25zdHJ1Y3Rvcih2bSwga2V5LCBjYikge1xyXG4gICAgdGhpcy5zdWJqZWN0cyA9IHt9O1xyXG4gICAgdGhpcy52bSA9IHZtO1xyXG4gICAgdGhpcy5rZXkgPSBrZXk7XHJcbiAgICB0aGlzLmNiID0gY2I7XHJcbiAgICB0aGlzLnZhbHVlID0gdGhpcy5nZXRWYWx1ZSgpO1xyXG4gIH1cclxuICB1cGRhdGUoKSB7XHJcbiAgICBsZXQgb2xkVmFsID0gdGhpcy52YWx1ZTtcclxuICAgIGxldCB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUoKTtcclxuICAgIGlmICh2YWx1ZSAhPT0gb2xkVmFsKSB7XHJcbiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgdGhpcy5jYi5iaW5kKHRoaXMudm0pKHZhbHVlLCBvbGRWYWwpO1xyXG4gICAgfVxyXG4gIH1cclxuICBzdWJzY3JpYmVUbyhzdWJqZWN0KSB7XHJcbiAgICBpZiAoIXRoaXMuc3ViamVjdHNbc3ViamVjdC5pZF0pIHtcclxuICAgICAgLy8gY29uc29sZS5sb2coXCJzdWJzY3JpYmVUby4uIFwiLCBzdWJqZWN0KTtcclxuICAgICAgc3ViamVjdC5hZGRPYnNlcnZlcih0aGlzKTtcclxuICAgICAgdGhpcy5zdWJqZWN0c1tzdWJqZWN0LmlkXSA9IHN1YmplY3Q7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGdldFZhbHVlKCkge1xyXG4gICAgY3VycmVudE9ic2VydmVyID0gdGhpcztcclxuICAgIGxldCB2YWx1ZSA9IHRoaXMudm0uJGRhdGFbdGhpcy5rZXldO1xyXG4gICAgY3VycmVudE9ic2VydmVyID0gbnVsbDtcclxuICAgIHJldHVybiB2YWx1ZTtcclxuICB9XHJcbn1cclxuXHJcbmNsYXNzIENvbXBpbGUge1xyXG4gIGNvbXBpbGUoKSB7XHJcbiAgICAvLyB0aHJvdyBuZXcgRXJyb3IoXCJNZXRob2Qgbm90IGltcGxlbWVudGVkLlwiKTtcclxuICAgIHRoaXMudHJhdmVyc2UodGhpcy5ub2RlKTtcclxuICB9XHJcbiAgdHJhdmVyc2Uobm9kZSkge1xyXG4gICAgLy8gdGhyb3cgbmV3IEVycm9yKFwiTWV0aG9kIG5vdCBpbXBsZW1lbnRlZC5cIik7XHJcbiAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gMSkge1xyXG4gICAgICB0aGlzLmNvbXBpbGVOb2RlKG5vZGUpO1xyXG4gICAgICBub2RlLmNoaWxkTm9kZXMuZm9yRWFjaChjaGlsZE5vZGUgPT4ge1xyXG4gICAgICAgIHRoaXMudHJhdmVyc2UoY2hpbGROb2RlKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2UgaWYgKG5vZGUubm9kZVR5cGUgPT09IDMpIHtcclxuICAgICAgLy/mlofmnKxcclxuICAgICAgdGhpcy5jb21waWxlVGV4dChub2RlKTtcclxuICAgIH1cclxuICB9XHJcbiAgY29tcGlsZU5vZGUobm9kZSkge1xyXG4gICAgLy8gdGhyb3cgbmV3IEVycm9yKFwiTWV0aG9kIG5vdCBpbXBsZW1lbnRlZC5cIik7XHJcbiAgICBsZXQgYXR0cnMgPSBbLi4ubm9kZS5hdHRyaWJ1dGVzXTtcclxuICAgIGNvbnNvbGUubG9nKFwiVENMOiBDb21waWxlIC0+IGNvbXBpbGVOb2RlIC0+IGF0dHJzXCIsIGF0dHJzKTtcclxuICAgIGF0dHJzLmZvckVhY2goYXR0ciA9PiB7XHJcbiAgICAgIGlmICh0aGlzLmlzTW9kZWxEaXJlY3RpdmUoYXR0ci5uYW1lKSkge1xyXG4gICAgICAgIGxldCBrZXkgPSBhdHRyLnZhbHVlO1xyXG4gICAgICAgIG5vZGUudmFsdWUgPSB0aGlzLnZtLiRkYXRhW2tleV07XHJcbiAgICAgICAgbmV3IE9ic2VydmVyKHRoaXMudm0sIGtleSwgZnVuY3Rpb24gKG5ld1ZhbCkge1xyXG4gICAgICAgICAgbm9kZS52YWx1ZSA9IG5ld1ZhbDtcclxuICAgICAgICB9KTtcclxuICAgICAgICBub2RlLm9uaW5wdXQgPSBlID0+IHtcclxuICAgICAgICAgIHRoaXMudm0uJGRhdGFba2V5XSA9IGUudGFyZ2V0LnZhbHVlO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0V2ZW50RGlyZWN0aXZlKGF0dHIubmFtZSkpIHtcclxuICAgICAgICBsZXQgZXZlbnRUeXBlID0gYXR0ci5uYW1lLnN1YnN0cigxKVxyXG4gICAgICAgIGxldCBtZXRob2ROYW1lID0gYXR0ci52YWx1ZVxyXG4gICAgICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihldmVudFR5cGUsIHRoaXMudm0uJG1ldGhvZHNbbWV0aG9kTmFtZV0pXHJcbiAgICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbiAgaXNFdmVudERpcmVjdGl2ZShuYW1lKSB7XHJcbiAgICAvLyB0aHJvdyBuZXcgRXJyb3IoXCJNZXRob2Qgbm90IGltcGxlbWVudGVkLlwiKTtcclxuICAgIHJldHVybiBuYW1lLmluZGV4T2YoJ0AnKSA9PT0gMFxyXG4gIH1cclxuICBpc01vZGVsRGlyZWN0aXZlKG5hbWUpIHtcclxuICAgIHJldHVybiBuYW1lID09PSBcInYtbW9kZWxcIjtcclxuICB9XHJcbiAgY29tcGlsZVRleHQobm9kZSkge1xyXG4gICAgY29uc29sZS5sb2coXCJUQ0w6IENvbXBpbGUgLT4gY29tcGlsZVRleHQgLT4gbm9kZVwiLCBub2RlKTtcclxuICAgIC8vIHRocm93IG5ldyBFcnJvcihcIk1ldGhvZCBub3QgaW1wbGVtZW50ZWQuXCIpO1xyXG4gICAgbGV0IHJlZyA9IC97eyguKz8pfX0vZztcclxuICAgIGxldCBtYXRjaDtcclxuICAgIHdoaWxlICgobWF0Y2ggPSByZWcuZXhlYyhub2RlLm5vZGVWYWx1ZSkpKSB7XHJcbiAgICAgIGxldCByYXcgPSBtYXRjaFswXTtcclxuICAgICAgbGV0IGtleSA9IG1hdGNoWzFdLnRyaW0oKTtcclxuICAgICAgbm9kZS5ub2RlVmFsdWUgPSBub2RlLm5vZGVWYWx1ZS5yZXBsYWNlKHJhdywgdGhpcy52bS4kZGF0YVtrZXldKTtcclxuICAgICAgbmV3IE9ic2VydmVyKHRoaXMudm0sIGtleSwgZnVuY3Rpb24odmFsLCBvbGRWYWwpIHtcclxuICAgICAgICBub2RlLm5vZGVWYWx1ZSA9IG5vZGUubm9kZVZhbHVlLnJlcGxhY2Uob2xkVmFsLCB2YWwpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbiAgY29uc3RydWN0b3Iodm0pIHtcclxuICAgIHRoaXMudm0gPSB2bTtcclxuICAgIHRoaXMubm9kZSA9IHZtLiRlbDtcclxuICAgIHRoaXMuY29tcGlsZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmlkb24ge1xyXG4gIGNvbnN0cnVjdG9yKG9wdHMpIHtcclxuICAgIHRoaXMuaW5pdChvcHRzKTtcclxuICAgIFJlYWN0aXZlKHRoaXMuJGRhdGEpO1xyXG4gICAgbmV3IENvbXBpbGUodGhpcyk7XHJcbiAgfVxyXG4gIGluaXQob3B0cykge1xyXG4gICAgdGhpcy4kZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG9wdHMuZWwpO1xyXG4gICAgdGhpcy4kZGF0YSA9IG9wdHMuZGF0YTtcclxuICAgIHRoaXMuJG1ldGhvZHMgPSBvcHRzLm1ldGhvZHNcclxuXHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLiRkYXRhKSB7XHJcbiAgICAgIGlmICh0aGlzLiRkYXRhLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywga2V5LCB7XHJcbiAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgZ2V0OiAoKSA9PiB7IFxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy4kZGF0YVtrZXldXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgc2V0OiBuZXdWYWwgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLiRkYXRhW2tleV0gPSBuZXdWYWxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy4kbWV0aG9kcykge1xyXG4gICAgICBpZiAodGhpcy4kbWV0aG9kcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIGtleSwge1xyXG4gICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgIGdldDogKCkgPT4geyBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuJG1ldGhvZHNba2V5XVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHNldDogKGZuKSA9PiB7IFxyXG4gICAgICAgICAgICB0aGlzLiRtZXRob2RzW2tleV0gPSBmblxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy4kbWV0aG9kc1trZXldID0gdGhpcy4kbWV0aG9kc1trZXldLmJpbmQodGhpcylcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCIvLyBAdHMtbm9jaGVja1xyXG5pbXBvcnQgVmlkb24gZnJvbSAnLi4vcGFja2FnZXMvVmlkb24uanMnO1xyXG5pbXBvcnQgJy4vc3R5bGUuY3NzJ1xyXG5cclxubGV0IHZtID0gbmV3IFZpZG9uKHtcclxuICBlbDogXCIjYXBwXCIsXHJcbiAgZGF0YToge1xyXG4gICAgbmFtZTogXCLlsI/pqazwn5C0XCIsXHJcbiAgICBhZ2U6IDEyLFxyXG4gICAgZ2VuZGVyOiBcIueUt1wiXHJcbiAgfSxcclxuICBtZXRob2RzOiB7XHJcbiAgICBzYXlIaSgpIHtcclxuICAgICAgYWxlcnQoYOS9oOWlvSwgJHt0aGlzLm5hbWV9YCk7XHJcbiAgICB9LFxyXG4gICAgYXV0bygpIHsgXHJcbiAgICAgIGFsZXJ0KCfmiJHoh6rlt7HmiafooYznmoQnKVxyXG4gICAgfVxyXG4gIH1cclxufSk7XHJcblxyXG4vLyBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbi8vICAgdm0uJGRhdGEuYWdlKytcclxuLy8gfSwgMTAwMClcclxuXHJcbnNldFRpbWVvdXQoKCkgPT4ge1xyXG4gIHZtLmFnZSA9IDIwXHJcbiAgdm0uYXV0bygpXHJcbiAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICB2bS5hdXRvID0gKCkgPT4geyBhbGVydCgnMuenkuWQjuaIkeWPiOW8ueWHuuadpeS6hicpIH1cclxuICAgIHZtLmF1dG8oKVxyXG4gIH0sIDIwMDApXHJcbiAgXHJcbn0sIDMwMDApIl0sInNvdXJjZVJvb3QiOiIifQ==